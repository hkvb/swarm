#!/usr/bin/env bash

  # START MODULE CONFIGURATION
DOLLAR='$'
export VCW_MODULE_PACKAGES="\
elastic:hkvb/elastic/search/traefik,\
grafana:hkvb/grafana/traefik,\
kafka:hkvb/confluent/kafka,\
kibana:hkvb/elastic/kibana/traefik,\
ksqldb:hkvb/confluent/ksqldb/traefik,\
schema_registry:hkvb/confluent/schema_registry/traefik,\
streamsets:hkvb/streamsets/traefik,\
zookeeper:hkvb/confluent/zookeeper"
# END MODULE CONFIGURATION

# START CONFIGURATION
export ELASTIC_MODULE_ELASTICSEARCH_MEMORY_LIMIT="1024m"
export ELASTIC_MODULE_ELASTICSEARCH_MEMORY_RESERVED="512m"
# END CONFIGURATION
# START CONFIGURATION
export GRAFANA_MODULE_GRAFANA_AUTH_ANONYMOUS_ORG_ROLE="Editor"
export GRAFANA_MODULE_GRAFANA_LOG_LEVEL="warning"
export GRAFANA_MODULE_GRAFANA_MEMORY_LIMIT="128m"
export GRAFANA_MODULE_GRAFANA_MEMORY_RESERVED="64m"
# END CONFIGURATION
# START CONFIGURATION
export KAFKA_MODULE_KAFKA_PORT="29092"
export KAFKA_MODULE_KAFKA_ADVERTISED_LISTENERS=",PLAINTEXT_HOST://${VCW_STACK_HOSTNAME}:${KAFKA_MODULE_KAFKA_PORT}"
export KAFKA_MODULE_KAFKA_LISTENER_SECURITY_PROTOCOL_MAP=",PLAINTEXT_HOST:PLAINTEXT"
export KAFKA_MODULE_KAFKA_ENVIRONMENT_EXTRA=""
export KAFKA_MODULE_KAFKA_PORT_EXPOSURE="${KAFKA_MODULE_KAFKA_PORT}:${KAFKA_MODULE_KAFKA_PORT}"
export KAFKA_MODULE_KAFKA_MEMORY_LIMIT="512m"
export KAFKA_MODULE_KAFKA_MEMORY_RESERVED="256m"
# END CONFIGURATION
# START CONFIGURATION
export KIBANA_MODULE_KIBANA_LOGGING_VERBOSE="false"
export KIBANA_MODULE_KIBANA_MEMORY_LIMIT="512m"
export KIBANA_MODULE_KIBANA_MEMORY_RESERVED="256m"
# END CONFIGURATION
# START CONFIGURATION
export KSQLDB_MODULE_KSQLDB_PORT="8088"
export KSQLDB_MODULE_KSQLDB_ENVIRONMENT_BOOTSTRAP_SERVERS="kafka:9092"
export KSQLDB_MODULE_KSQLDB_ENVIRONMENT_KSQL_HOST_NAME="${VCW_STACK_HOSTNAME}"
export KSQLDB_MODULE_KSQLDB_MEMORY_LIMIT="1536m"
export KSQLDB_MODULE_KSQLDB_MEMORY_RESERVED="1024m"
export KSQLDB_MODULE_KSQLDB_ENVIRONMENT_EXTRA=", \
'KSQL_PRODUCER_INTERCEPTOR_CLASSES=io.confluent.monitoring.clients.interceptor.MonitoringProducerInterceptor', \
'KSQL_CONSUMER_INTERCEPTOR_CLASSES=io.confluent.monitoring.clients.interceptor.MonitoringConsumerInterceptor', \
'KSQL_KSQL_SCHEMA_REGISTRY_URL=http://${VCW_STACK_HOSTNAME}:8081', \
'KSQL_KSQL_ADVERTISED_LISTENER=http://${VCW_STACK_HOSTNAME}:80/vcw_stack/ksqldb', \
'KSQL_LISTENERS=http://0.0.0.0:8088'
"
#export VCW_STACK_KSQLDB_MODE=",'KSQL_LISTENERS=http://0.0.0.0:8088','KSQL_KSQL_SCHEMA_REGISTRY_URL=http://schema_registry:8081'"
#export VCW_STACK_KSQLDB_CONSOLE=",'KSQL_LISTENERS=http://0.0.0.0:8088','KSQL_KSQL_SCHEMA_REGISTRY_URL=http://schema_registry:8081'"
#export VCW_STACK_KSQLDB_HEADLESS=",'KSQL_KSQL_QUERIES_FILE=','KSQL_KSQL_SCHEMA_REGISTRY_URL=http://schema_registry:8081'"

#KSQL_PRODUCER_INTERCEPTOR_CLASSES: "io.confluent.monitoring.clients.interceptor.MonitoringProducerInterceptor"
#KSQL_CONSUMER_INTERCEPTOR_CLASSES: "io.confluent.monitoring.clients.interceptor.MonitoringConsumerInterceptor"
#KSQL_KSQL_SCHEMA_REGISTRY_URL: "http://schema-registry:8081"
#KSQL_KSQL_CONNECT_URL: "http://connect:8083"

#'KSQL_SECURITY_PROTOCOL=SASL_SSL',\
#'KSQL_SASL_JAAS_CONFIG=org.apache.kafka.common.security.plain.PlainLoginModule required username=\"${DOLLAR}{VCW_STACK_KSQLDB_ENVIRONMENT_SASL_JAAS_CONFIG_CLUSTER_API_KEY}\" password=\"${DOLLAR}{VCW_STACK_KSQLDB_ENVIRONMENT_SASL_JAAS_CONFIG_CLUSTER_API_SECRET}\";',\
#'KSQL_SASL_MECHANISM=PLAIN',\
#'KSQL_SSL_ENDPOINT_IDENTIFICATION_ALGORITHM=HTTPS',\
#'KSQL_PRODUCER_INTERCEPTOR_CLASSES=io.confluent.monitoring.clients.interceptor.MonitoringProducerInterceptor',\
#'KSQL_PRODUCER_CONFLUENT_MONITORING_INTERCEPTOR_SASL_MECHANISM=PLAIN',\
#'KSQL_PRODUCER_CONFLUENT_MONITORING_INTERCEPTOR_SECURITY_PROTOCOL=SASL_SSL',\
#'KSQL_PRODUCER_CONFLUENT_MONITORING_INTERCEPTOR_SASL_JAAS_CONFIG=org.apache.kafka.common.security.plain.PlainLoginModule required username=\"${DOLLAR}{VCW_STACK_KSQLDB_ENVIRONMENT_PRODUCER_CONFLUENT_MONITORING_INTERCEPTOR_SASL_JAAS_CONFIG_CLUSTER_API_KEY}\" password=\"${DOLLAR}{VCW_STACK_KSQLDB_ENVIRONMENT_PRODUCER_CONFLUENT_MONITORING_INTERCEPTOR_SASL_JAAS_CONFIG_CLUSTER_API_SECRET}\";',\
#'KSQL_CONSUMER_INTERCEPTOR_CLASSES=io.confluent.monitoring.clients.interceptor.MonitoringConsumerInterceptor',\
#'KSQL_CONSUMER_CONFLUENT_MONITORING_INTERCEPTOR_SASL_MECHANISM=PLAIN',\
#'KSQL_CONSUMER_CONFLUENT_MONITORING_INTERCEPTOR_SECURITY_PROTOCOL=SASL_SSL',\
#'KSQL_CONSUMER_CONFLUENT_MONITORING_INTERCEPTOR_SASL_JAAS_CONFIG=org.apache.kafka.common.security.plain.PlainLoginModule required username=\"${DOLLAR}{VCW_STACK_KSQLDB_ENVIRONMENT_CONSUMER_CONFLUENT_MONITORING_INTERCEPTOR_SASL_JAAS_CONFIG_CLUSTER_API_KEY}\" password=\"${DOLLAR}{VCW_STACK_KSQLDB_ENVIRONMENT_CONSUMER_CONFLUENT_MONITORING_INTERCEPTOR_SASL_JAAS_CONFIG_CLUSTER_API_SECRET}\";'\
#'KSQL_KSQL_SCHEMA_REGISTRY_URL=${DOLLAR}{VCW_STACK_KSQLDB_ENVIRONMENT_SCHEMA_REGISTRY_URL}',\
#'KSQL_KSQL_SCHEMA_REGISTRY_BASIC_AUTH_CREDENTIALS_SOURCE=${DOLLAR}{VCW_STACK_KSQLDB_ENVIRONMENT_SCHEMA_REGISTRY_API_KEY}',\
#'KSQL_KSQL_SCHEMA_REGISTRY_BASIC_AUTH_USER_INFO=${DOLLAR}{VCW_STACK_KSQLDB_ENVIRONMENT_SCHEMA_REGISTRY_API_SECRET}'\

# END CONFIGURATION
# START CONFIGURATION
export SCHEMA_REGISTRY_MODULE_SCHEMA_REGISTRY_PORT_EXPOSURE="8081:8081"
export SCHEMA_REGISTRY_MODULE_SCHEMA_REGISTRY_ENVIRONMENT_KAFKASTORE_BOOTSTRAP_SERVERS="kafka:9092"
export SCHEMA_REGISTRY_MODULE_SCHEMA_REGISTRY_MEMORY_LIMIT="512m"
export SCHEMA_REGISTRY_MODULE_SCHEMA_REGISTRY_MEMORY_RESERVED="256m"
export SCHEMA_REGISTRY_MODULE_SCHEMA_REGISTRY_ENVIRONMENT_EXTRA=""

#'SCHEMA_REGISTRY_KAFKASTORE_SSL_ENDPOINT_IDENTIFIED_ALGORITHM=https', \
#'SCHEMA_REGISTRY_KAFKASTORE_SECURITY_PROTOCOL=SASL_SSL', \
#'SCHEMA_REGISTRY_KAFKASTORE_SASL_JAAS_CONFIG=org.apache.kafka.common.security.plain.PlainLoginModule required username=\"${DOLLAR}{VCW_STACK_SCHEMA_REGISTRY_ENVIRONMENT_SASL_JAAS_CONFIG_CLUSTER_API_KEY}\" password=\"${DOLLAR}{VCW_STACK_SCHEMA_REGISTRY_ENVIRONMENT_SASL_JAAS_CONFIG_CLUSTER_API_SECRET}\";',\
#'SCHEMA_REGISTRY_KAFKASTORE_SASL_MECHANISM=PLAIN'"

# END CONFIGURATION
# START CONFIGURATION
export STREAMSETS_MODULE_STREAMSETS_MEMORY_LIMIT="768m"
export STREAMSETS_MODULE_STREAMSETS_MEMORY_RESERVED="512m"
# END CONFIGURATION
# START CONFIGURATION
export ZOOKEEPER_MODULE_ZOOKEEPER_MEMORY_LIMIT="128m"
export ZOOKEEPER_MODULE_ZOOKEEPER_MEMORY_RESERVED="64m"
# END CONFIGURATION
